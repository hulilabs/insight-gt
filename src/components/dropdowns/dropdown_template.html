<div class="wc-Dropdown" v-bind:class="{ 'wc-Dropdown--secondary' : showSecondaryStyle }" v-on:keydown="_detectKeydown">
    <div v-if="native">

        <wc-input-container
            v-bind:class="{ 'is-empty' : !state.inputText, 'wc-Dropdown__inputContainer--secondary' : showSecondaryStyle }"
            v-bind:disabled="disabled"
            v-bind:error-message="errorMessage"
            v-bind:has-error="hasError"
            v-bind:hide-input-highlighter="hideInputHighlighter || showSecondaryStyle"
            v-bind:hint-text="hintText"
            v-bind:label-for="state.id"
            v-bind:label="placeholder"
            v-bind:native-error="nativeError"
            v-bind:required="required"
            v-bind:value="state.inputText">

            <template slot-scope="inputContainerScope">
                <div v-bind:class="{ 'wc-Dropdown__mobilePlaceholder' : !state.value }">
                    <select ref="select"
                        tabindex="0"
                        v-bind:class="[inputContainerScope.inputClass]"
                        v-bind:disabled="disabled"
                        v-bind:id="state.id"
                        v-bind:style="inlineCssDropdown"
                        v-on:blur="inputContainerScope.onBlur"
                        v-on:change="_onMobileChangeHandler"
                        v-on:focus="inputContainerScope.onFocus">
                            <option v-if="altPlaceholder" class="wc-Dropdown__mobileOption" selected v-bind:value="null">{{ altPlaceholder }}</option>
                            <option
                                class="wc-Dropdown__mobileOption"
                                v-for="(option, index) in options"
                                v-bind:key="index"
                                v-bind:data-avatar="option.avatar"
                                v-bind:data-color="option.color"
                                v-bind:disabled="option.disabled"
                                v-bind:selected="option.value == state.value"
                                v-bind:style="{ 'color' : option.color }"
                                v-bind:value="option.value">
                                {{ option.text }} {{ option.hint }} {{ option.secondaryText }}
                            </option>
                    </select>
                </div>

                <div class="wc-Dropdown__action" v-bind:class="{ 'wc-Dropdown__action--withLabel' : placeholder }">
                    <wc-icon icon-class="icon-angle-down"></wc-icon>
                </div>
            </template>
        </wc-input-container>

    </div>

    <div v-else class="wc-Dropdown--desktop" v-bind:class="{ 'wc-Dropdown--icon' : state.icon, 'wc-Dropdown--disabled' : disabled }">

        <div class="wc-Dropdown__input">
            <div v-if="!disabled" class="wc-Dropdown__icon">
                <wc-icon v-if="state.icon" v-bind:icon-class="state.icon"></wc-icon>
            </div>

            <wc-input-container
                ref="inputContainer"
                class="wc-Dropdown__inputContainer"
                v-bind:class="{ 'is-empty' : !state.inputText, 'wc-Dropdown__inputContainer--secondary' : showSecondaryStyle }"
                v-bind:disabled="disabled"
                v-bind:error-message="errorMessage"
                v-bind:floating-label="floatingLabel"
                v-bind:has-error="hasError"
                v-bind:hide-input-highlighter="hideInputHighlighter || showSecondaryStyle"
                v-bind:hint-text="hintText"
                v-bind:id="state.id"
                v-bind:label-for="state.id"
                v-bind:label="label"
                v-bind:native-error="nativeError"
                v-bind:placeholder="!setIconOnly ? placeholder : null"
                v-bind:required="required"
                v-bind:style="inlineCssDropdown"
                v-bind:value="state.inputText">

                <template slot-scope="inputContainerScope">
                    <button ref="input"
                        class="wc-Dropdown__inputContent"
                        role="combobox"
                        tabindex="0"
                        v-bind:class="[inputContainerScope.inputClass]"
                        v-bind:disabled="disabled"
                        v-bind:style="inlineCssDropdown"
                        v-on:blur="inputContainerScope.onBlur"
                        v-on:focus="inputContainerScope.onFocus"
                        v-on:keyup.space.prevent="handleSpaceKey">
                        <wc-avatar v-if="state.avatar" class="wc-Dropdown__avatar" v-bind:image-path="state.avatar"></wc-avatar>
                        <span class="wc-Dropdown__inputText"
                            v-bind:class="{ 'has-ellipsis' : ellipsis }">
                            {{state.inputText}}
                        </span>
                    </button>
                </template>

                <wc-icon slot="action"
                    class="wc-InputContainer__action"
                    tabindex="-1"
                    icon-class="icon-angle-down">
                </wc-icon>

            </wc-input-container>
        </div>

        <wc-menu
            v-if="!disabled"
            v-bind:trigger-element-selector="'#' + state.id"
            v-on:menu-close="_onMenuClosed"
            v-on:menu-open="_onMenuOpened"
            v-bind:menu-class="[
                'wc-Dropdown__menuContent',
                'wc-Menu--overflow'
            ]"
            ref="dropdownMenu"
            role="listbox"
            class="wc-Dropdown__menu"
            trigger-origin="bottom-left"
            floating-direction="right">

            <wc-list-item
                v-if="placeholder && !setIconOnly"
                v-on:click.native.stop="_clear"
                class="wc-Dropdown__option wc-Dropdown__placeholderOption"
                role="menuitem">
                {{ state.placeholderText }}
            </wc-list-item>

            <div v-if="placeholder && !setIconOnly" class="wc-Divider wc-Divider--verticalSpace"></div>
            <wc-list-item
                role="menuitem"
                v-for="(option, index) in options"
                v-bind:key="index"
                v-bind:disabled="option.disabled"
                v-bind:layout="option.secondaryText ? 'double' : 'single'"
                v-bind:value="option.value"
                v-on:click.native.stop="_selectOption(option)">
                <wc-avatar v-if="option.avatar" slot="avatar" v-bind:image-path="option.avatar"></wc-avatar>
                <span slot="primaryText" v-bind:style="{ 'color' : option.color }">
                    {{ option.text }} <span class="wc-Dropdown__hint" v-if="option.hint">{{ option.hint }}</span>
                </span>
                <span v-if="option.secondaryText" slot="secondaryText">{{ option.secondaryText }}</span>
                <wc-icon v-if="option.iconClass" slot="icon" v-bind:icon-class="option.iconClass"></wc-icon>
            </wc-list-item>
        </wc-menu>
    </div>
</div>
